<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ibenben.mapper.CustomerMapper" >
  <resultMap id="BaseResultMap" type="com.ibenben.domain.Customer" >
    <id column="customer_id" property="customerId" jdbcType="INTEGER" />
    <result column="customer_sn" property="customerSn" jdbcType="VARCHAR" />
    <result column="customer_name" property="customerName" jdbcType="VARCHAR" />
    <result column="customer_type" property="customerType" jdbcType="CHAR" />
    <result column="customer_status" property="customerStatus" jdbcType="CHAR" />
    <result column="contact_name" property="contactName" jdbcType="VARCHAR" />
    <result column="contact_phone" property="contactPhone" jdbcType="VARCHAR" />
    <result column="contact_address" property="contactAddress" jdbcType="VARCHAR" />
    <result column="business_licence_name" property="businessLicenceName" jdbcType="VARCHAR" />
    <result column="business_licence_path" property="businessLicencePath" jdbcType="VARCHAR" />
    <result column="taxpayer_qualification_name" property="taxpayerQualificationName" jdbcType="VARCHAR" />
    <result column="taxpayer_qualification_path" property="taxpayerQualificationPath" jdbcType="VARCHAR" />
    <result column="receipt_name" property="receiptName" jdbcType="VARCHAR" />
    <result column="receipt_path" property="receiptPath" jdbcType="VARCHAR" />
    <result column="created_time" property="createdTime" jdbcType="TIMESTAMP" />
    <result column="created_user" property="createdUser" jdbcType="VARCHAR" />
    <result column="last_updated_user" property="lastUpdatedUser" jdbcType="VARCHAR" />
    <result column="last_updated_time" property="lastUpdatedTime" jdbcType="TIMESTAMP" />
    <result column="customer_trait" property="customerTrait" jdbcType="CHAR" />
    <result column="personal_bank_name" property="personalBankName" jdbcType="VARCHAR" />
    <result column="personal_account_name" property="personalAccountName" jdbcType="VARCHAR" />
    <result column="personal_account_id" property="personalAccountId" jdbcType="VARCHAR" />
    <result column="business_bank_name" property="businessBankName" jdbcType="VARCHAR" />
    <result column="business_account_name" property="businessAccountName" jdbcType="VARCHAR" />
    <result column="business_account_id" property="businessAccountId" jdbcType="VARCHAR" />
    <result column="receipt_type" property="receiptType" jdbcType="CHAR" />
    <result column="taxpayer_qualification" property="taxpayerQualification" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap type="java.util.Map" id="CustomerListMap">
    <id column="customer_id" property="customer_id" jdbcType="INTEGER" />
    <result column="customer_name" property="customer_name" jdbcType="VARCHAR" />
    <result column="customer_type" property="customer_type" jdbcType="CHAR" />
    <result column="customer_status" property="customer_status" jdbcType="CHAR" />
    <result column="created_time" property="created_time" jdbcType="TIMESTAMP" />
    <result column="customer_sn" property="customer_sn" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap type="java.util.Map" id="SimpleMap">
    <id column="customer_id" property="customer_id" jdbcType="INTEGER" />
    <result column="customer_name" property="customer_name" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap type="java.util.Map" id="CustomerMerchantMap">
    <result column="customer_id" property="customer_id" jdbcType="INTEGER" />
    <result column="customer_name" property="customer_name" jdbcType="VARCHAR" />
    <result column="merchant_id" property="merchant_id" jdbcType="INTEGER" />
    <result column="merchant_name" property="merchant_name" jdbcType="VARCHAR" />
  </resultMap>
  
  <sql id="Base_Column_List" >
    customer_id, customer_sn, customer_name, customer_type, customer_status, contact_name, 
    contact_phone, contact_address, business_licence_name, business_licence_path, taxpayer_qualification_name, 
    taxpayer_qualification_path, receipt_name, receipt_path, created_time, created_user, 
    last_updated_user, last_updated_time, customer_trait, personal_bank_name, personal_account_name, 
    personal_account_id, business_bank_name, business_account_name, business_account_id, 
    receipt_type,taxpayer_qualification
  </sql>
  
  <select id="isExist" parameterType="java.util.Map" resultType="java.lang.Integer">
    select
    count(*)
    from customer_merchant_mapping
    where customer_id = #{customer_id,jdbcType=INTEGER}
    and merchant_id = #{merchant_id,jdbcType=INTEGER}
  </select>
  
  <insert id="addCustomerMerchant" parameterType="java.util.Map">
    insert into 
    customer_merchant_mapping
    (customer_id,merchant_id)
    values
    (#{customer_id,jdbcType=INTEGER},#{merchant_id,jdbcType=INTEGER})
  </insert>
  
  <delete id="delCustomerMerchant" parameterType="java.util.Map">
    delete from
    customer_merchant_mapping
    where
    customer_id = #{customer_id,jdbcType=INTEGER} and
    merchant_id = #{merchant_id,jdbcType=INTEGER}
  </delete>
  
  <select id="getCustomerMerchant" parameterType="java.lang.Integer" resultMap="CustomerMerchantMap">
    select
    c.customer_id,
    c.customer_name,
    m.merchant_id,
    m.merchant_name
    from customer_merchant_mapping cmm
    inner join customer c on c.customer_id = cmm.customer_id
    inner join merchant m on m.merchant_id = cmm.merchant_id
    where cmm.customer_id = #{customer_id,jdbcType=INTEGER}
  </select>
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select 
    <include refid="Base_Column_List" />
    from customer
    where customer_id = #{customerId,jdbcType=INTEGER}
  </select>
  
  <select id="getSimpleCustomerList" parameterType="java.util.Map" resultMap="SimpleMap">
    select customer_id,customer_name
    from customer
  </select>
  
  <select id="getCustomerList" parameterType="java.util.Map" resultMap="CustomerListMap">
    select 
    customer_id,customer_name,customer_type,customer_status,created_time,customer_sn
    from customer
    <where>
      <if test="customer_type != '' and customer_type != null">
        customer_type = #{customer_type,jdbcType=CHAR}
      </if>
      <if test="customer_status != '' and customer_status != null">
        and customer_status = #{customer_status,jdbcType=CHAR}
      </if>
      <if test="customer_id != '' and customer_id != null">
        and customer_id = #{customer_id,jdbcType=INTEGER}
      </if>
      <if test="customer_sn != null and customer_sn != ''">
        and customer_sn = #{customer_sn}
      </if>
      <if test="customer_name != null and customer_name != ''">
        and customer_name like concat('%',#{customer_sn},'%')
      </if>
    </where>
  </select>
  
  <select id="getCustomerByIds" resultType="java.util.Map">
  	select 
    	customer_id,customer_name,customer_type,customer_status,created_time,customer_sn
    from customer
    where customer_id in
    	<foreach collection="list" index="index" item="item" open="(" close=")" separator=",">
    		#{item}
    	</foreach>
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from customer
    where customer_id = #{customerId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.ibenben.domain.Customer" >
    insert into customer (customer_id, customer_sn, customer_name, 
      customer_type, customer_status, contact_name, 
      contact_phone, contact_address, business_licence_name, 
      business_licence_path, taxpayer_qualification_name, 
      taxpayer_qualification_path, receipt_name, 
      receipt_path, created_time, created_user, 
      last_updated_user, last_updated_time, customer_trait, 
      personal_bank_name, personal_account_name, 
      personal_account_id, business_bank_name, business_account_name, 
      business_account_id, receipt_type)
    values (#{customerId,jdbcType=INTEGER}, #{customerSn,jdbcType=VARCHAR}, #{customerName,jdbcType=VARCHAR}, 
      #{customerType,jdbcType=CHAR}, #{customerStatus,jdbcType=CHAR}, #{contactName,jdbcType=VARCHAR}, 
      #{contactPhone,jdbcType=VARCHAR}, #{contactAddress,jdbcType=VARCHAR}, #{businessLicenceName,jdbcType=VARCHAR}, 
      #{businessLicencePath,jdbcType=VARCHAR}, #{taxpayerQualificationName,jdbcType=VARCHAR}, 
      #{taxpayerQualificationPath,jdbcType=VARCHAR}, #{receiptName,jdbcType=VARCHAR}, 
      #{receiptPath,jdbcType=VARCHAR}, #{createdTime,jdbcType=TIMESTAMP}, #{createdUser,jdbcType=VARCHAR}, 
      #{lastUpdatedUser,jdbcType=VARCHAR}, #{lastUpdatedTime,jdbcType=TIMESTAMP}, #{customerTrait,jdbcType=CHAR}, 
      #{personalBankName,jdbcType=VARCHAR}, #{personalAccountName,jdbcType=VARCHAR}, 
      #{personalAccountId,jdbcType=VARCHAR}, #{businessBankName,jdbcType=VARCHAR}, #{businessAccountName,jdbcType=VARCHAR}, 
      #{businessAccountId,jdbcType=VARCHAR}, #{receiptType,jdbcType=CHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.ibenben.domain.Customer" >
    insert into customer
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="customerId != null" >
        customer_id,
      </if>
      <if test="customerSn != null" >
        customer_sn,
      </if>
      <if test="customerName != null" >
        customer_name,
      </if>
      <if test="customerType != null" >
        customer_type,
      </if>
      <if test="customerStatus != null" >
        customer_status,
      </if>
      <if test="contactName != null" >
        contact_name,
      </if>
      <if test="contactPhone != null" >
        contact_phone,
      </if>
      <if test="contactAddress != null" >
        contact_address,
      </if>
      <if test="businessLicenceName != null" >
        business_licence_name,
      </if>
      <if test="businessLicencePath != null" >
        business_licence_path,
      </if>
      <if test="taxpayerQualificationName != null" >
        taxpayer_qualification_name,
      </if>
      <if test="taxpayerQualificationPath != null" >
        taxpayer_qualification_path,
      </if>
      <if test="receiptName != null" >
        receipt_name,
      </if>
      <if test="receiptPath != null" >
        receipt_path,
      </if>
      <if test="createdTime != null" >
        created_time,
      </if>
      <if test="createdUser != null" >
        created_user,
      </if>
      <if test="lastUpdatedUser != null" >
        last_updated_user,
      </if>
      <if test="lastUpdatedTime != null" >
        last_updated_time,
      </if>
      <if test="customerTrait != null" >
        customer_trait,
      </if>
      <if test="personalBankName != null" >
        personal_bank_name,
      </if>
      <if test="personalAccountName != null" >
        personal_account_name,
      </if>
      <if test="personalAccountId != null" >
        personal_account_id,
      </if>
      <if test="businessBankName != null" >
        business_bank_name,
      </if>
      <if test="businessAccountName != null" >
        business_account_name,
      </if>
      <if test="businessAccountId != null" >
        business_account_id,
      </if>
      <if test="receiptType != null and receiptType != ''" >
        receipt_type,
      </if>
      <if test="taxpayerQualification != null">
        taxpayer_qualification,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="customerId != null" >
        #{customerId,jdbcType=INTEGER},
      </if>
      <if test="customerSn != null" >
        #{customerSn,jdbcType=VARCHAR},
      </if>
      <if test="customerName != null" >
        #{customerName,jdbcType=VARCHAR},
      </if>
      <if test="customerType != null" >
        #{customerType,jdbcType=CHAR},
      </if>
      <if test="customerStatus != null" >
        #{customerStatus,jdbcType=CHAR},
      </if>
      <if test="contactName != null" >
        #{contactName,jdbcType=VARCHAR},
      </if>
      <if test="contactPhone != null" >
        #{contactPhone,jdbcType=VARCHAR},
      </if>
      <if test="contactAddress != null" >
        #{contactAddress,jdbcType=VARCHAR},
      </if>
      <if test="businessLicenceName != null" >
        #{businessLicenceName,jdbcType=VARCHAR},
      </if>
      <if test="businessLicencePath != null" >
        #{businessLicencePath,jdbcType=VARCHAR},
      </if>
      <if test="taxpayerQualificationName != null" >
        #{taxpayerQualificationName,jdbcType=VARCHAR},
      </if>
      <if test="taxpayerQualificationPath != null" >
        #{taxpayerQualificationPath,jdbcType=VARCHAR},
      </if>
      <if test="receiptName != null" >
        #{receiptName,jdbcType=VARCHAR},
      </if>
      <if test="receiptPath != null" >
        #{receiptPath,jdbcType=VARCHAR},
      </if>
      <if test="createdTime != null" >
        #{createdTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createdUser != null" >
        #{createdUser,jdbcType=VARCHAR},
      </if>
      <if test="lastUpdatedUser != null" >
        #{lastUpdatedUser,jdbcType=VARCHAR},
      </if>
      <if test="lastUpdatedTime != null" >
        #{lastUpdatedTime,jdbcType=TIMESTAMP},
      </if>
      <if test="customerTrait != null" >
        #{customerTrait,jdbcType=CHAR},
      </if>
      <if test="personalBankName != null" >
        #{personalBankName,jdbcType=VARCHAR},
      </if>
      <if test="personalAccountName != null" >
        #{personalAccountName,jdbcType=VARCHAR},
      </if>
      <if test="personalAccountId != null" >
        #{personalAccountId,jdbcType=VARCHAR},
      </if>
      <if test="businessBankName != null" >
        #{businessBankName,jdbcType=VARCHAR},
      </if>
      <if test="businessAccountName != null" >
        #{businessAccountName,jdbcType=VARCHAR},
      </if>
      <if test="businessAccountId != null" >
        #{businessAccountId,jdbcType=VARCHAR},
      </if>
      <if test="receiptType != null and receiptType != ''" >
        #{receiptType,jdbcType=CHAR},
      </if>
      <if test="taxpayerQualification != null">
        #{taxpayerQualification,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.ibenben.domain.Customer" >
    update customer
    <set >
      <if test="customerSn != null" >
        customer_sn = #{customerSn,jdbcType=VARCHAR},
      </if>
      <if test="customerName != null" >
        customer_name = #{customerName,jdbcType=VARCHAR},
      </if>
      <if test="customerType != null" >
        customer_type = #{customerType,jdbcType=CHAR},
      </if>
      <if test="customerStatus != null" >
        customer_status = #{customerStatus,jdbcType=CHAR},
      </if>
      <if test="contactName != null" >
        contact_name = #{contactName,jdbcType=VARCHAR},
      </if>
      <if test="contactPhone != null" >
        contact_phone = #{contactPhone,jdbcType=VARCHAR},
      </if>
      <if test="contactAddress != null" >
        contact_address = #{contactAddress,jdbcType=VARCHAR},
      </if>
      <if test="businessLicenceName != null" >
        business_licence_name = #{businessLicenceName,jdbcType=VARCHAR},
      </if>
      <if test="businessLicencePath != null" >
        business_licence_path = #{businessLicencePath,jdbcType=VARCHAR},
      </if>
      <if test="taxpayerQualificationName != null" >
        taxpayer_qualification_name = #{taxpayerQualificationName,jdbcType=VARCHAR},
      </if>
      <if test="taxpayerQualificationPath != null" >
        taxpayer_qualification_path = #{taxpayerQualificationPath,jdbcType=VARCHAR},
      </if>
      <if test="receiptName != null" >
        receipt_name = #{receiptName,jdbcType=VARCHAR},
      </if>
      <if test="receiptPath != null" >
        receipt_path = #{receiptPath,jdbcType=VARCHAR},
      </if>
      <if test="createdTime != null" >
        created_time = #{createdTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createdUser != null" >
        created_user = #{createdUser,jdbcType=VARCHAR},
      </if>
      <if test="lastUpdatedUser != null" >
        last_updated_user = #{lastUpdatedUser,jdbcType=VARCHAR},
      </if>
      <if test="lastUpdatedTime != null" >
        last_updated_time = #{lastUpdatedTime,jdbcType=TIMESTAMP},
      </if>
      <if test="customerTrait != null" >
        customer_trait = #{customerTrait,jdbcType=CHAR},
      </if>
      <if test="personalBankName != null" >
        personal_bank_name = #{personalBankName,jdbcType=VARCHAR},
      </if>
      <if test="personalAccountName != null" >
        personal_account_name = #{personalAccountName,jdbcType=VARCHAR},
      </if>
      <if test="personalAccountId != null" >
        personal_account_id = #{personalAccountId,jdbcType=VARCHAR},
      </if>
      <if test="businessBankName != null" >
        business_bank_name = #{businessBankName,jdbcType=VARCHAR},
      </if>
      <if test="businessAccountName != null" >
        business_account_name = #{businessAccountName,jdbcType=VARCHAR},
      </if>
      <if test="businessAccountId != null" >
        business_account_id = #{businessAccountId,jdbcType=VARCHAR},
      </if>
      <if test="receiptType != null" >
        receipt_type = #{receiptType,jdbcType=CHAR},
      </if>
      <if test="taxpayerQualification != null">
        taxpayer_qualification = #{taxpayerQualification,jdbcType=VARCHAR},
      </if>
    </set>
    where customer_id = #{customerId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.ibenben.domain.Customer" >
    update customer
    set customer_sn = #{customerSn,jdbcType=VARCHAR},
      customer_name = #{customerName,jdbcType=VARCHAR},
      customer_type = #{customerType,jdbcType=CHAR},
      customer_status = #{customerStatus,jdbcType=CHAR},
      contact_name = #{contactName,jdbcType=VARCHAR},
      contact_phone = #{contactPhone,jdbcType=VARCHAR},
      contact_address = #{contactAddress,jdbcType=VARCHAR},
      business_licence_name = #{businessLicenceName,jdbcType=VARCHAR},
      business_licence_path = #{businessLicencePath,jdbcType=VARCHAR},
      taxpayer_qualification_name = #{taxpayerQualificationName,jdbcType=VARCHAR},
      taxpayer_qualification_path = #{taxpayerQualificationPath,jdbcType=VARCHAR},
      receipt_name = #{receiptName,jdbcType=VARCHAR},
      receipt_path = #{receiptPath,jdbcType=VARCHAR},
      created_time = #{createdTime,jdbcType=TIMESTAMP},
      created_user = #{createdUser,jdbcType=VARCHAR},
      last_updated_user = #{lastUpdatedUser,jdbcType=VARCHAR},
      last_updated_time = #{lastUpdatedTime,jdbcType=TIMESTAMP},
      customer_trait = #{customerTrait,jdbcType=CHAR},
      personal_bank_name = #{personalBankName,jdbcType=VARCHAR},
      personal_account_name = #{personalAccountName,jdbcType=VARCHAR},
      personal_account_id = #{personalAccountId,jdbcType=VARCHAR},
      business_bank_name = #{businessBankName,jdbcType=VARCHAR},
      business_account_name = #{businessAccountName,jdbcType=VARCHAR},
      business_account_id = #{businessAccountId,jdbcType=VARCHAR},
      receipt_type = #{receiptType,jdbcType=CHAR},
      taxpayer_qualification = #{taxpayerQualification,jdbcType=VARCHAR}
    where customer_id = #{customerId,jdbcType=INTEGER}
  </update>
</mapper>